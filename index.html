<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Limbus Company Draft Hub - Multiplayer</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="style.css">
    <style>
        .site-disclaimers {
            font-family: 'Courier New', Courier, monospace;
            font-size: 0.9rem;
            color: #aaa;
            border-top: 1px dashed #444;
            padding-top: 15px;
            margin-top: 20px;
        }
        .site-disclaimers h4 {
            font-family: 'Inter', sans-serif; /* Revert heading font */
            color: #ccc;
            font-size: 1.1rem;
        }
        .site-disclaimers ul {
            list-style-position: inside;
        }
    </style>
</head>
<body>
    <div id="rejoin-overlay" style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.8); z-index: 9999; color: white; display: none; flex-direction: column; align-items: center; justify-content: center; font-size: 2rem; gap: 20px;">
        <i class="fas fa-sync fa-spin"></i>
        <p>Attempting to rejoin lobby...</p>
        <button class="btn btn-secondary" id="cancel-rejoin-btn" style="margin-top: 20px;">Cancel</button>
    </div>

    <div class="connection-status" id="connection-status">
        <i class="fas fa-plug"></i>
        <span>Connecting...</span>
    </div>

    <div class="notification" id="notification">Player joined the lobby!</div>

    <!-- Modals -->
    <div id="coin-flip-modal" class="modal-overlay hidden">
        <div class="modal-content">
            <h2>Coin Flip</h2>
            <div class="coin" id="coin-icon"><div class="coin-inner"></div></div>
            <p id="coin-flip-status">Referee is starting the coin flip...</p>
            <div id="turn-choice-buttons" class="hidden">
                <button class="btn btn-primary" id="go-first-btn">Go First</button>
                <button class="btn btn-secondary" id="go-second-btn">Go Second</button>
            </div>
        </div>
    </div>
    <div id="rules-modal" class="modal-overlay hidden">
        <div class="modal-content">
            <button id="close-rules-btn" class="close-modal-btn">&times;</button>
            <h2>Tournament Rules</h2>
            <div class="rules-content">
                <!-- START: Updated Rules Section -->
                <h3>Tournament Application</h3>
                <h4>How to Apply</h4>
                <p>Players interested in participating must fill out the official application Google Form, which will be posted in the Prydwen Discord server.</p>
                <h4>Application Deadline</h4>
                <p>Applications will close on <strong>Thursday, August 28th, at 5:00 PM GMT+3</strong>.</p>
                <h4>Selection Process</h4>
                <p>Filling out the application form does not guarantee a spot in the tournament. Organizers will select 32 players to participate in a fair way.</p>

                <hr style="margin: 20px 0;">

                <h3>1. Roster Submission: Preparing Your IDs</h3>
                <p>Before a player can compete, they must declare which IDs they might use by submitting a roster. To prepare a roster, players must visit <a href="https://limbusdraftcode.onrender.com/" target="_blank">https://limbusdraftcode.onrender.com/</a> and use the "Roster Builder" function with the 42-ID setting. Once the roster is finalized, players must copy the generated code for submission.</p>
                <h4>Submission Method</h4>
                <p>Players must send their generated roster codes directly to the Tournament Organizer (Solvenir) via Discord Direct Message. The TO will add them to a private master sheet. At the 15-minute deadline, the submitted rosters will be shared publicly.</p>
                <h4>Submission Deadlines & Roster Rules</h4>
                <ul>
                    <li><strong>For the Group Stage:</strong> Because group stage matches are played back-to-back, each player must submit all three of their 42-ID rosters at least 15 minutes before their first scheduled match begins. Players must clearly label which roster is for their first, second, and third match respectively.</li>
                    <li><strong>For Best of 3 Matches (Playoffs):</strong> Each player must submit three 42-ID rosters before the series begins.</li>
                    <li><strong>For the Best of 5 Final:</strong> Each player must submit five 42-ID rosters before the series begins.</li>
                </ul>
                <h4>General Roster Policies</h4>
                <ul>
                    <li><strong>Roster Uniqueness:</strong> Submitted rosters do not have to be different. Players may submit the same roster code for multiple matches or series if they wish.</li>
                    <li><strong>Failure to Submit:</strong> If a player misses the submission deadline, they will be assigned a pre-made, standard roster for the match or series.</li>
                    <li><strong>Banned IDs:</strong> "Heishou Pack - Mao Branch Adept Faust" is banned and cannot be included on any roster or used in any match.</li>
                    <li><strong>Roster Usage in Playoffs:</strong> For a Best of 3 or Best of 5 series, each submitted roster can only be used once. Using a roster more than once will result in a forfeit of the game where the illegal roster was used. It is the player's responsibility to track which rosters have been used.</li>
                </ul>

                <hr style="margin: 20px 0;">

                <h3>2. Tournament Structure & Schedule</h3>
                <h4>Group Stage (September 2nd - 3rd)</h4>
                <p>Players will be divided into 8 groups of 4. Each player will play one Best of 1 "Section 1" match against every other person in their group, for a total of three matches. All 3 matches will be played in succession with a 15 minute break in-between. The player with the most wins in each group advances directly to the Quarter-finals.</p>
                <p><strong>Group Stage Tiebreakers:</strong> If there is a tie in wins, the winner will be decided by the player with the lowest total turn count across all three matches. If still tied, the player with the fastest combined real-time clear speeds.</p>
                <p><em>Group stage will be streamed by Frapollo.</em></p>
                <h4>Playoff Stage (September 4th - 7th)</h4>
                <p>All playoff rounds are single-elimination and will be streamed.</p>
                <ul>
                    <li><strong>Quarter-finals (September 4th - 5th):</strong> Two Best of 3 series will be played each day.</li>
                    <li><strong>Semi-finals (September 6th):</strong> Two Best of 3 series will be played.</li>
                    <li><strong>Finals (September 7th):</strong> One Best of 5 series will be played to determine the champion.</li>
                </ul>
                <p><em>Playoff stage will be streamed by Welvader.</em></p>
                <h4>Prize Pool: $200 USD</h4>
                <ul>
                    <li><strong>1st Place:</strong> $100</li>
                    <li><strong>2nd Place:</strong> $60</li>
                    <li><strong>3rd Place:</strong> $40</li>
                </ul>
                <p><em>Note: There will be a bo3 between the semi-final losers match to determine the 3rd place.</em></p>

                <hr style="margin: 20px 0;">

                <h3>3. The Pre-Match Phase: Draft & Setup</h3>
                <p>The official draft will be conducted using the web application found at: <a href="https://limbusdraftcode.onrender.com/" target="_blank">https://limbusdraftcode.onrender.com/</a></p>
                <h4>Determining Draft Order</h4>
                <p>Before draft, a coin flip decides who drafts first. The winner chooses to go first or second.</p>
                <h4>Draft Time Limits</h4>
                <ul>
                    <li>Each player has <strong>15 seconds</strong> for each individual pick or ban.</li>
                    <li>Each player has a <strong>2-minute reserve time bank</strong> for the entire draft.</li>
                    <li><strong>Time Penalty:</strong> If a player runs out of reserve time and exceeds the 15-second limit, the draft application will automatically lock in the ID they are currently hovering over. If the player is not hovering over any ID, they forfeit that pick/ban, and the draft proceeds.</li>
                </ul>
                <h4>Step-by-Step Draft Structure</h4>
                <p>(Each player will draft a total of 12 IDs) (P1 is the player that's going first)</p>
                <ul>
                    <li><strong>Phase 1: EGO Ban Phase</strong> (P1 Bans 5 -> P2: Ban 5)</li>
                    <li><strong>Phase 2: First ID Ban Phase</strong> (Alternating bans starting from P1, 4 bans each side)</li>
                    <li><strong>Phase 3: First Pick Phase</strong> (P1 picks 2 -> P2 picks 3 -> P1 picks 2 -> P2 picks 3 -> P1 picks 2)</li>
                    <li><strong>Phase 4: Second ID Ban Phase</strong> (Alternating bans starting from P2, 3 bans each side)</li>
                    <li><strong>Phase 5: Second Pick Phase</strong> (P2 picks 2 -> P1 picks 3 -> P2 picks 2 -> P1 picks 3 -> P2 picks 2)</li>
                </ul>
                <h4>General Draft Rules</h4>
                <ul>
                    <li><strong>Targeted Bans:</strong> Each player bans IDs directly from their opponent's submitted roster for that match.</li>
                    <li><strong>Universal Ban Effect:</strong> When an ID is banned from an opponent's roster, it is removed from play for both players for that match. Meaning if the banning player also has that ID on their own roster, they will be unable to pick it as well.</li>
                </ul>
                <h4>Final Preparation</h4>
                <p>A 180-second period follows the draft before the match begins. Players will prepare their team on the Section 1 team preparation screen. And the match timer will begin with the refs countdown after the preparation period.</p>

                <hr style="margin: 20px 0;">

                <h3>4. Match Officiating & In-Game Rules</h3>
                <p>A designated Referee will be present for every match to officiate and enforce the rules.</p>
                <h4>Win Condition</h4>
                <p>The player who clears the section in fewer turns wins. If turn counts are tied, the player who cleared faster in real-time wins. The match Referee will record and report the results.</p>
                <h4>Sudden Death Protocol</h4>
                <p>Sudden Death begins 25 minutes into a match. The official timer is kept by the Referee.</p>
                <ul>
                    <li>If one player has cleared when the timer hits 25 minutes, they instantly win.</li>
                    <li>If neither has cleared, a 10-minute grace period begins. During this period, the first player to clear wins. The match ends and the player that hasn’t cleared will have their turn count recorded as +1 of the highest turn count of the group stages and their time will be recorded as 35 minutes.</li>
                    <li>If no one clears in the grace period, the winner will be the player who is closest to clearing the section. If both players are on the final abnormality, the winner is the player who has brought the boss to the lowest HP percentage at the moment the grace period timer ends.</li>
                </ul>
                <h4>Restart Rules</h4>
                <p>Each player has <strong>10 "Turn 1" Restarts</strong> and <strong>3 "Normal" Restarts</strong> per game. No restarts are allowed during Sudden Death.</p>

                <hr style="margin: 20px 0;">

                <h3>5. Player Conduct & Policies</h3>
                <h4>Code of Conduct & Sportsmanship</h4>
                <p>All participants are expected to maintain a high standard of sportsmanship and respect. Harassment, toxic behavior, abusive language, or any action that creates a hostile environment for other players or staff is strictly prohibited and may result in disqualification. Play fair and be respectful.</p>
                <h4>Punctuality & Forfeiture</h4>
                <p>Players are required to be present in the designated Discord voice channel and ready for their match at least <strong>15 minutes before</strong> the scheduled start time. Failure to appear <strong>10 minutes</strong> before the scheduled start time will result in an immediate disqualification from the match.</p>
                <h4>Technical Issues & Disconnects Policy</h4>
                <ul>
                    <li><strong>Draft App Crash:</strong> If the draft application crashes, the Referee will pause the proceedings. The draft will be reset, and the Referee will manually input all picks and bans to restore the draft to its state before the crash.</li>
                    <li><strong>Streaming Issues:</strong> If a player's stream fails, the match and the official timer will be paused while the issue is resolved.</li>
                    <li><strong>In-Game Internet Issues:</strong> A brief, single disconnect from the game will not stop the match timer. If a player experiences a persistent internet or hardware issue, they may request one technical pause per match (The referee will decide if it will be given or not if the issue isn’t observable by the referee). The timer will be stopped for a maximum of 10 minutes, and their opponent must pause the game. If the issue is not resolved within 10 minutes, a forfeiture may be enforced.</li>
                </ul>
                <h4>Match Conduct & Streaming</h4>
                <ul>
                    <li><strong>Pre-Match Setup:</strong> Players must be in the designated Discord voice channel 10 minutes before their scheduled match time for stream setup and verification with the Referee.</li>
                    <li><strong>Audio Requirement:</strong> Players must remain in the voice channel for the duration of the match. Muting is permitted, but players may not deafen themselves.</li>
                    <li><strong>Streaming Requirement:</strong> Players must stream their gameplay using vdo.ninja for the entire match, from the start of the draft until the match concludes, in at least 720p.</li>
                    <li><strong>Cheating:</strong> Any form of cheating will result in immediate disqualification from the tournament.</li>
                </ul>

                <hr style="margin: 20px 0;">

                <h3>6. Communication & Support</h3>
                <h4>Official Announcements</h4>
                <p>All tournament-related announcements, schedules, and communications will be made in the official Prydwen Discord server. It is the player's responsibility to stay updated. Join here: <a href="https://discord.gg/prydwen" target="_blank">https://discord.gg/prydwen</a></p>
                <h4>Dispute Process</h4>
                <p>If a player has a dispute or issue during a match, they should contact the user Solvenir directly via Discord DMs with a detailed explanation of the situation.</p>
                <h4>Tournament Organizer (TO) Rulings</h4>
                <p>The appointed Tournament Organizers (Solvenir and Soundwave) and match Referees have the final authority on all rule interpretations and decisions.</p>

                <hr style="margin: 20px 0;">

                <p><em>Special thanks to antillar, ultranumhere, soundwave3514, oiprocs, ooft, frapollo9494, and welvader for their contributions to the organization of this tournament.</em></p>
                
                <div class="site-disclaimers">
                    <h4>Site Disclaimers & Fair Play</h4>
                    <ul>
                        <li><strong>Service Stability:</strong> This tool is hosted on a free service. Lobbies may be automatically cleared after a period of inactivity (approximately 15 minutes). Please try to complete drafts in one session to avoid disruption.</li>
                        <li><strong>Data Privacy:</strong> No personal information is stored permanently. Player names and roster selections are temporary and exist only for the duration of an active lobby.</li>
                        <li><strong>Use "As-Is":</strong> This tool is provided for community use without any warranties. The organizer is not responsible for any technical issues that may arise.</li>
                        <li><strong>Fair Play:</strong> Please be respectful to all participants. Any form of harassment or malicious behavior will not be tolerated.</li>
                    </ul>
                </div>
                <!-- END: Updated Rules Section -->
            </div>
        </div>
    </div>
    <div id="role-selection-modal" class="modal-overlay hidden">
        <div class="modal-content">
            <button id="close-role-modal-btn" class="close-modal-btn">&times;</button>
            <h3>Select Your Role for Lobby <span id="role-modal-lobby-code"></span></h3>
            <div class="role-options" id="modal-role-options">
                <!-- Role options will be dynamically enabled/disabled -->
            </div>
            <button class="btn btn-primary btn-large" id="confirm-join-btn" style="margin-top: 20px;" disabled>Join Lobby</button>
        </div>
    </div>


    <div class="container">
        <div id="main-page">
            <div class="top-left-controls">
                <button id="show-rules-btn" class="btn btn-secondary btn-small"><i class="fas fa-book-open"></i> Rules</button>
            </div>

            <header>
                 <h1><img src="/uploads/cropped-limbus_logo_feather.webp" alt="Limbus Logo" class="header-logo"> Limbus Company Draft Hub</h1>
                <p>Organize and participate in competitive drafting sessions</p>
            </header>

            <div class="logo">
                <img src="/uploads/cropped-limbus_logo_feather.webp" alt="Limbus Company Logo">
            </div>
          
            <div class="welcome-text">
                <p>Welcome to the official Limbus Company Draft Hub. Here you can create or join lobbies to organize competitive matches with other players, or use the Roster Builder to prepare your teams in advance.</p>
            </div>
            
            <div class="form-group" style="max-width: 400px; margin: 30px auto; text-align: left;">
                <label for="player-name">Your Display Name</label>
                 <input type="text" id="player-name" placeholder="Enter your name" maxlength="50" required>
            </div>

            <div class="action-container">
                <div class="action-card">
                    <div class="action-icon"><i class="fas fa-users-cog"></i></div>
                    <h3 class="action-title">Roster Builder</h3>
                     <p class="action-description" id="builder-roster-description">Create a 42 or 52-ID roster and generate a shareable code for quick loading.</p>
                    <button class="btn btn-secondary btn-large" id="go-to-builder"><i class="fas fa-wrench"></i> Open Builder</button>
                </div>

                <div class="action-card">
                     <div class="action-icon"><i class="fas fa-plus-circle"></i></div>
                    <h3 class="action-title">Create New Lobby</h3>
                    <p class="action-description">Start a new drafting session as the referee. You'll get a unique lobby code to share with players.</p>
                    <div class="lobby-options">
                        <div class="form-group">
                            <label for="match-type-select">Match Type</label>
                             <select id="match-type-select">
                                <option value="section1" selected>Section 1 Only</option>
                                <option value="allSections">All Sections</option>
                             </select>
                        </div>
                        <div class="form-group">
                            <label for="draft-logic-select">Draft Logic</label>
                             <select id="draft-logic-select">
                                <option value="1-2-2" selected>Standard (1-2-2)</option>
                                <option value="2-3-2">Alternate (2-3-2)</option>
                             </select>
                        </div>
                        <div class="form-group">
                            <label for="roster-size-select">Roster Size</label>
                            <select id="roster-size-select">
                                <option value="42" selected>42 IDs</option>
                                <option value="52">52 IDs</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="timer-toggle">Enable Timer</label>
                             <select id="timer-toggle">
                                <option value="false" selected>Off</option>
                                <option value="true">On</option>
                             </select>
                        </div>
                    </div>
                    <button class="btn btn-primary btn-large" id="create-lobby"><i class="fas fa-plus"></i> Create Lobby</button>
                 </div>
                
                <div class="action-card" id="join-lobby-card">
                    <div class="action-icon"><i class="fas fa-sign-in-alt"></i></div>
                    <h3 class="action-title">Join a Lobby</h3>
                    <div class="join-tab-content active" id="code-join-tab">
                        <div class="form-group">
                            <label for="lobby-code-input">Lobby Code:</label>
                            <input type="text" id="lobby-code-input" placeholder="Enter 6-character code" maxlength="6">
                        </div>
                        <button class="btn btn-primary" id="enter-lobby-by-code"><i class="fas fa-play"></i> Find Lobby</button>
                    </div>
                </div>
            </div>
        </div>
        
        
        <div id="lobby-view" class="hidden">
            <button class="btn back-button" id="back-to-main-lobby"><i class="fas fa-arrow-left"></i> Main Menu</button>
            
            <header>
                <h1><img src="/uploads/cropped-limbus_logo_feather.webp" alt="Limbus Logo" class="header-logo"> Limbus Company Draft Hub</h1>
                <p>Drafting session in progress</p>
            </header>
            
            <div class="card">
                <div class="lobby-info">
                    <div>
                        <h3>LOBBY CODE</h3>
                         <div class="code-display-wrapper">
                            <div class="code-display" id="lobby-code-display"></div>
                            <button id="toggle-code-visibility" class="btn btn-small btn-secondary"><i class="fas fa-eye"></i></button>
                        </div>
                         <p>Share this code with other participants</p>
                    </div>
                    <div>
                        <h3>PARTICIPANTS</h3>
                         <div class="participants" id="participants-list"></div>
                    </div>
                </div>
                
                <!-- Roster Selection Phase -->
                 <div id="roster-phase" class="phase-section">
                    <h2 id="roster-phase-title">Roster Selection Phase</h2>
                    <div class="filter-bar" id="global-filter-bar-roster">
                        <!-- Filters are now globally defined and rendered by JS -->
                    </div>
                     <div class="player-area">
                        <div class="player-panel" id="p1-panel">
                            <div class="player-header">
                                <div class="player-name" id="p1-name-display">Player 1</div>
                                 <div class="player-status status-waiting" id="p1-status">Selecting</div>
                            </div>
                            <div class="counter"><i class="fas fa-users"></i> Selected: <strong id="p1-counter">0</strong> / <span id="p1-roster-size">42</span> IDs</div>
                             <div class="roster-load-form">
                                <input type="text" id="p1-roster-code-input" placeholder="Paste Roster Code...">
                                <button class="btn btn-secondary" id="p1-roster-load"><i class="fas fa-upload"></i> Load</button>
                            </div>
                            <div class="roster-selection" id="p1-roster"></div>
                            <div class="controls">
                                 <button class="btn" id="p1-random"><i class="fas fa-random"></i> Randomize</button>
                                <button class="btn" id="p1-clear"><i class="fas fa-trash"></i> Clear</button>
                                <button class="btn" id="p1-ready"><i class="fas fa-check"></i> Ready</button>
                             </div>
                        </div>
                        <div class="player-panel" id="p2-panel">
                             <div class="player-header">
                                <div class="player-name" id="p2-name-display">Player 2</div>
                                <div class="player-status status-waiting" id="p2-status">Selecting</div>
                             </div>
                             <div class="counter"><i class="fas fa-users"></i> Selected: <strong id="p2-counter">0</strong> / <span id="p2-roster-size">42</span> IDs</div>
                            <div class="roster-load-form">
                                 <input type="text" id="p2-roster-code-input" placeholder="Paste Roster Code...">
                                <button class="btn btn-secondary" id="p2-roster-load"><i class="fas fa-upload"></i> Load</button>
                            </div>
                            <div class="roster-selection" id="p2-roster"></div>
                            <div class="controls">
                                 <button class="btn" id="p2-random"><i class="fas fa-random"></i> Randomize</button>
                                <button class="btn" id="p2-clear"><i class="fas fa-trash"></i> Clear</button>
                                <button class="btn" id="p2-ready"><i class="fas fa-check"></i> Ready</button>
                            </div>
                        </div>
                    </div>
                     <div class="ref-actions" style="text-align: center; margin-top: 20px;">
                        <button class="btn btn-primary btn-large" id="start-coin-flip" disabled><i class="fas fa-coins"></i> Start Coin Flip</button>
                    </div>
                </div>

                <!-- EGO Ban Phase -->
                <div id="ego-ban-phase" class="phase-section hidden">
                    <h2 id="ego-ban-title">EGO Ban Phase</h2>
                    <div id="p1-ego-bans-preview" class="banned-egos-display hidden">
                        <h3>Player 1's Bans</h3>
                        <div class="banned-egos-list"></div>
                    </div>
                    <div class="ego-ban-layout">
                        <div id="ego-ban-main-panel">
                            <h3>Available EGOs</h3>
                            <div class="filter-bar">
                                <div class="filter-group" style="flex-grow: 2;">
                                    <label class="filter-label" for="ego-search-input">Search EGOs:</label>
                                    <input type="text" id="ego-search-input" placeholder="Search by name or sinner...">
                                </div>
                                <button class="btn btn-primary" id="confirm-selection-ego" disabled><i class="fas fa-check"></i> Confirm Ban</button>
                            </div>
                            <div class="ego-ban-container" id="ego-ban-container"></div>
                        </div>
                        <div id="ego-ban-side-panel">
                            <div id="ego-ban-player-bans-section">
                                <h3>Your Bans (<span id="ego-ban-counter">0</span>/5)</h3>
                                <div id="current-player-ego-bans"></div>
                                <div class="controls" style="margin-top: 20px;">
                                    <button class="btn btn-primary hidden" id="confirm-ego-bans" disabled><i class="fas fa-check-double"></i> Confirm All Bans</button>
                                </div>
                            </div>
                            <div id="opponent-roster-display">
                                <h3 id="opponent-roster-title">Opponent's Roster</h3>
                                <div class="sinner-grouped-roster" id="opponent-roster-list"></div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- ID Draft Phase -->
                <div id="id-draft-phase" class="phase-section hidden">
                    <div class="banned-egos-display" id="draft-banned-egos">
                        <h3><i class="fas fa-ban"></i> Banned EGOs</h3>
                        <div class="banned-egos-list" id="draft-banned-egos-list"></div>
                    </div>
                
                    <div class="triptych-layout">
                        <!-- Left Column: Player 1 Info -->
                        <div class="draft-player-column" id="p1-draft-column">
                            <div class="player-header">
                                <div class="player-name" id="p1-draft-name">Player 1</div>
                                <div class="player-status status-waiting" id="p1-draft-status">Waiting</div>
                            </div>
                            <div class="reserve-timer-display">
                                Reserve: <span id="p1-reserve-time">02:00</span>
                            </div>
                            <h4>Picked IDs</h4>
                            <div class="compact-id-list" id="p1-picks"></div>
                            <div id="p1-s2-picks-container" class="hidden">
                                <h4>Picked IDs (Extended)</h4>
                                <div class="compact-id-list section2-picks" id="p1-s2-picks"></div>
                            </div>
                            <h4>Banned IDs</h4>
                            <div class="compact-id-list" id="p1-id-bans"></div>
                        </div>
                
                        <!-- Center Column: Interaction Hub -->
                        <div class="draft-interaction-hub" id="draft-interaction-hub">
                            <div class="filter-bar" id="global-filter-bar-draft">
                                <!-- Filters for draft phase rendered here by JS -->
                            </div>
                            <div class="draft-pool-container" id="draft-pool-container">
                                <!-- Draft pool will be rendered here by JS -->
                            </div>
                             <div class="draft-controls">
                                <button class="btn btn-primary btn-large" id="confirm-selection-id" disabled><i class="fas fa-check"></i> Confirm Selection</button>
                                <button class="btn hidden" id="next-phase" disabled><i class="fas fa-step-forward"></i> Next Phase</button>
                                <button class="btn hidden" id="complete-draft" disabled><i class="fas fa-flag-checkered"></i> Complete Draft</button>
                            </div>
                        </div>
                
                        <!-- Right Column: Player 2 Info -->
                        <div class="draft-player-column" id="p2-draft-column">
                            <div class="player-header">
                                <div class="player-name" id="p2-draft-name">Player 2</div>
                                <div class="player-status status-waiting" id="p2-draft-status">Waiting</div>
                            </div>
                            <div class="reserve-timer-display">
                                Reserve: <span id="p2-reserve-time">02:00</span>
                            </div>
                            <h4>Picked IDs</h4>
                            <div class="compact-id-list" id="p2-picks"></div>
                             <div id="p2-s2-picks-container" class="hidden">
                                <h4>Picked IDs (Sec 2/3)</h4>
                                <div class="compact-id-list section2-picks" id="p2-s2-picks"></div>
                            </div>
                            <h4>Banned IDs</h4>
                            <div class="compact-id-list" id="p2-id-bans"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Roster Builder Page -->
        <div id="roster-builder-page" class="hidden">
            <button class="btn back-button" id="back-to-main-builder"><i class="fas fa-arrow-left"></i> Main Menu</button>
            <header>
                <h1><i class="fas fa-users-cog"></i> Roster Builder</h1>
                <p>Create a roster and generate a shareable code.</p>
            </header>
            <div class="card">
                <div class="builder-sinner-nav" id="builder-sinner-nav">
                    <!-- Sinner buttons will be rendered here -->
                </div>
                <div class="builder-content-wrapper">
                    <div class="builder-main-panel">
                        <h3>Available Identities</h3>
                         <div class="filter-bar" id="global-filter-bar-builder"></div>
                         <div class="builder-id-pool" id="builder-id-pool">
                             <!-- Sinner IDs will be rendered here -->
                         </div>
                    </div>
                    <div class="builder-side-panel">
                        <div class="builder-roster-size-selector" id="builder-roster-size-selector">
                            <button class="btn btn-small active" data-size="42">42-ID Roster</button>
                            <button class="btn btn-small" data-size="72">72-ID Roster</button>
                        </div>
                        <h3>Your Roster (<span id="builder-counter">0</span>/<span id="builder-roster-size">42</span>)</h3>
                        <div class="sinner-grouped-roster" id="builder-selected-roster"></div>
                        <div class="controls" style="margin-top: 10px;">
                            <button class="btn" id="builder-random"><i class="fas fa-random"></i> Simple Random</button>
                            <button class="btn" id="builder-clear"><i class="fas fa-trash"></i> Clear</button>
                        </div>
                        <div class="advanced-random-container">
                            <button class="btn btn-secondary" id="toggle-advanced-random" style="width: 100%; margin-top: 10px;">
                                <i class="fas fa-sliders-h"></i> Advanced Random
                            </button>
                            <div id="advanced-random-options" class="hidden">
                                <h4>Sinner Count Constraints</h4>
                                <p>Set the min/max number of IDs for each sinner. The total must be <span class="advanced-random-roster-size">42</span>.</p>
                                <div id="sinner-sliders-container">
                                    <!-- Sliders will be generated by JS -->
                                </div>
                                <div id="advanced-random-summary" class="advanced-random-summary">
                                    Total Min: <span id="total-min-display">0</span> / <span class="advanced-random-roster-size">42</span>
                                    <br>
                                    Total Max: <span id="total-max-display">0</span> / <span class="advanced-random-roster-size">42</span>
                                </div>
                                <button class="btn btn-primary" id="builder-advanced-random" style="width: 100%; margin-top: 15px;">
                                    <i class="fas fa-cogs"></i> Generate Roster
                                </button>
                            </div>
                        </div>
                        <h3 style="margin-top: 20px;">Roster Code</h3>
                        <p>Use this code to quickly load your roster here or in a match lobby.</p>
                        <div id="builder-roster-code-display" style="background: #111; padding: 10px; border-radius: 5px; font-family: monospace; min-height: 50px; margin-top: 10px; word-wrap: break-word;">
                            Select 42 IDs to generate a code.
                        </div>
                        <button class="btn btn-primary" id="builder-copy-code" style="width: 100%; margin-top: 10px;" disabled><i class="fas fa-copy"></i> Copy Code</button>
                        
                        <h3 style="margin-top: 20px;">Load from Code</h3>
                        <div class="roster-code-actions">
                            <input type="text" id="builder-load-code-input" placeholder="Paste code here...">
                            <button class="btn" id="builder-load-code"><i class="fas fa-upload"></i></button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Completed Draft View -->
        <div id="completed-view" class="hidden">
            <header>
                <h1><i class="fas fa-flag-checkered"></i> Draft Complete</h1>
                <p>Final Rosters</p>
            </header>
            <div class="banned-egos-display" id="final-banned-egos">
                <h3><i class="fas fa-ban"></i> Banned EGOs</h3>
                <div class="banned-egos-list" id="final-banned-egos-list"></div>
            </div>
            <div class="final-rosters-container">
                <div class="final-player-panel">
                    <h2 id="final-p1-name">Player 1's Roster</h2>
                    <h4>Picked IDs</h4>
                    <div class="final-picks" id="final-p1-picks"></div>
                    <div id="final-p1-s2-picks-container" class="hidden">
                        <h4>Picked IDs (Sections 2 & 3)</h4>
                        <div class="final-picks section2-picks" id="final-p1-s2-picks"></div>
                    </div>
                    <h3>Banned IDs</h3>
                    <div class="final-bans" id="final-p1-bans"></div>
                </div>
                <div class="final-player-panel">
                    <h2 id="final-p2-name">Player 2's Roster</h2>
                    <h4>Picked IDs</h4>
                    <div class="final-picks" id="final-p2-picks"></div>
                    <div id="final-p2-s2-picks-container" class="hidden">
                        <h4>Picked IDs (Sections 2 & 3)</h4>
                        <div class="final-picks section2-picks" id="final-p2-s2-picks"></div>
                    </div>
                    <h3>Banned IDs</h3>
                    <div class="final-bans" id="final-p2-bans"></div>
                </div>
            </div>
            <button class="btn btn-large btn-primary" id="restart-draft"><i class="fas fa-redo"></i> Start New Draft</button>
        </div>
    </div>

    <div id="draft-status-panel" class="hidden">
        <div class="status-text">
            <h3 id="current-phase">Waiting for draft to start...</h3>
            <p id="draft-action-description"></p>
        </div>
        <div class="status-timer">
            <div class="timer-display" id="phase-timer">--:--</div>
            <button class="btn btn-secondary btn-small" id="ref-timer-control" style="margin-top: 5px;"><i class="fas fa-pause"></i></button>
        </div>
    </div>

    <script src="data.js"></script>
    <script src="script.js"></script>
</body>
</html>
